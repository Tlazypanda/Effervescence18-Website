<!DOCTYPE html>
<html lang="en" >

<head>
  <meta charset="UTF-8">
  <title>Create New User</title>
  
  
      {% load static %}
      <link rel="stylesheet" href="{% static 'login/css/style.css' %}">

  
</head>

<body>


{% csrf_token %}
  <div class="wrapper">
<!-- <div class="container-fluid card">
      <div class="row card-row">
        <div class="col-xs-0 col-md-4"></div>
        <div class="col-xs-12 col-md-4">
        </div>
      </div>
    </div> -->


  <div class="container">
    <h1>Create New User</h1>
    
    <form class="form">

    {% csrf_token %}
    <input type='text' name='username' id='username' placeholder="Username" />
    <input type='email' name='email' id='email' placeholder="Email" />
    <input type='password' name='password1' id='password1' placeholder="Enter Password" />
    <input type='password' name='password2' id='password2' placeholder="Confirm Password" />


      <button type="submit" id="login-button" class="login_form">Create User</button>
    </form>

    <div class="container-fluid">
      <div class="row">
        <div class="col-12" style="text-align: center; margin-top: 60px;">
          <p class="register-user">Existing User? &ensp;   
          <a href="{% url 'user_login' %}" class="register-link">Login</a>
        </p>
        </div>
      </div>
    </div>
  </div>

  


    
  

</div>
    <script src="http://cdnjs.cloudflare.com/ajax/libs/jquery/2.1.3/jquery.min.js"></script>
  <script  src="{% static 'login/js/index.js' %}"></script>

<script>
  $(".login_form").on("click", function(e) {
    var username = $("#username").val();
    var email = $("#email").val();
    var password1 = $("#password1").val();
    var password2 = $("#password2").val();
    
    $.ajax({
      url : "/api/registration/",
      type : 'post',
      data : {
        "username" : username,
        "email" : email,
        "password1" : password1,
        "password2" : password2,
      },
      dataType : 'json',
      success: function(data){
        var token = data["key"];
        localStorage.setItem("token", token);
        window.location.href = "/set_user_details/";
      },
      error: function(MLHttpRequest, textStatus, errorThrown){
      for(key in MLHttpRequest.responseJSON){
          alert(MLHttpRequest.responseJSON[key]);
        }
      window.location.href = "/set_new_user/";
    },
    });
  });
</script>



</body>

</html>





